<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì•¡ìƒ ì†Œìš¸ë©”ì´íŠ¸ ì°¾ê¸°</title>
    <style>
        :root { --primary: #E5000D; --bg: #f0f2f5; --text: #111010; --star: #fdcb6e; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; padding: 20px; }
        
        #app { background: white; width: 100%; max-width: 500px; border-radius: 24px; padding: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); text-align: center; margin: auto; transition: all 0.3s ease; }
        
        .step { display: none; animation: fadeIn 0.4s ease-out; }
        .step.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        h1 { font-size: 2.2rem; margin-bottom: 1rem; color: var(--primary); }
        h3 { font-size: 1.6rem; margin-bottom: 2rem; line-height: 1.4; font-weight: 600; }
        p { font-size: 1.1rem; line-height: 1.6; color: #555; }

        .tag-container { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 25px 0; }
        .tag { border: 2px solid #dfe6e9; padding: 10px 16px; border-radius: 50px; cursor: pointer; font-size: 1rem; background: white; transition: 0.2s; user-select: none; }
        .tag.selected { background: var(--primary); color: white; border-color: var(--primary); font-weight: bold; }

        .option-group { margin-bottom: 35px; text-align: left; }
        .label-text { display: block; font-size: 1.2rem; font-weight: bold; margin-bottom: 15px; color: #2d3436; }
        .score-row { display: flex; justify-content: space-between; gap: 8px; }
        .score-btn { flex: 1; border: 2px solid #dfe6e9; padding: 15px 0; border-radius: 12px; background: white; cursor: pointer; font-size: 1.1rem; font-weight: bold; transition: 0.2s; user-select: none; }
        .score-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        .btn { width: 100%; background: var(--primary); color: white; border: none; padding: 18px; border-radius: 12px; cursor: pointer; font-size: 1.1rem; font-weight: 600; box-shadow: 0 4px 12px rgba(229, 0, 13, 0.25); transition: 0.2s; user-select: none; text-transform: uppercase; letter-spacing: 0.5px; }
        .btn:active, .score-btn:active, .tag:active { transform: scale(0.96); }
        
        .rank-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: #e0e0e0;
            width: 45px;
            flex-shrink: 0;
            line-height: 1;
        }

        /* ê²°ê³¼ í™”ë©´ ìŠ¤íƒ€ì¼ */
        #res-list { display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px; }
        .result-card { 
            background: linear-gradient(145deg, #ffffff, #f9f9f9);
            border: 1px solid #f0f0f0;
            padding: 20px;
            border-radius: 20px; 
            display: flex;
            gap: 15px;
            align-items: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.07);
            transition: transform 0.2s ease-in-out;
            animation: slideUp 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards;
            opacity: 0;
        }
        .result-card:hover {
            transform: translateY(-5px);
        }
        .vape-img { width: 120px; height: 120px; background: #f1f1f1; border-radius: 16px; object-fit: contain; flex-shrink: 0; }
        .vape-info { flex: 1; text-align: left; }
        .vape-name { font-size: 1.2rem; font-weight: bold; margin-bottom: 6px; color: #2d3436; }
        .vape-flavor { font-size: 0.9rem; color: #888; margin-bottom: 15px; }
        
        .star-box { width: 100%; display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .star-label { font-weight: bold; color: #2d3436; font-size: 0.8rem; }
        .stars { color: var(--star); font-size: 1.1rem; letter-spacing: 1px; }

        #alert-msg { color: #e74c3c; font-weight: bold; margin-top: 10px; display: none; }

        /* ë‚˜ì˜ ì„ íƒ ìš”ì•½ ìŠ¤íƒ€ì¼ */
        .summary-box {
            background: #f7f7f7;
            border: 1px solid #eee;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 30px;
            text-align: left;
            animation: slideUp 0.5s ease-out forwards;
        }
        .summary-box h4 { margin: 0 0 15px 0; font-size: 1.1rem; color: #333; text-align: center; font-weight: 600; }
        .summary-item { display: flex; justify-content: space-between; align-items: center; font-size: 0.95rem; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed #ddd; }
        .summary-item:last-child { margin-bottom: 0; border-bottom: none; padding-bottom: 0; }
        .summary-item .label { font-weight: 500; color: #555; }
        .summary-item .value { color: #111; font-weight: bold; background: none; padding: 0; font-size: 0.95rem; max-width: 65%; word-break: keep-all; text-align: right; }
        .summary-item .summary-stars { background: none; padding: 0; color: var(--star); font-size: 1.2rem; letter-spacing: 1px; }

        /* ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 480px) {
            body { padding: 0; align-items: stretch; }
            #app { border-radius: 0; box-shadow: none; padding: 30px 20px; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; }
            .step { width: 100%; }
            h1 { font-size: 2rem; }
        }
    </style>
</head>
<body>

<div id="app">
    <div id="step1" class="step active">
        <img src="https://api.momubox.co.kr/images/originals/1764058538874-%E1%84%83%E1%85%A1%E1%86%B7%E1%84%90%E1%85%A1_%E1%84%89%E1%85%A9%E1%84%89%E1%85%A7%E1%86%AF%E1%84%86%E1%85%B5%E1%84%83%E1%85%B5%E1%84%8B%E1%85%A5-%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%91%E1%85%B5%E1%86%AF-%E1%84%8B%E1%85%B5%E1%84%86%E1%85%B5%E1%84%8C%E1%85%B5.png" alt="ë¡œê³ " style="display: none; max-width: 150px; height: auto; margin-bottom: 20px;">

        <p>ë‚´ ì·¨í–¥ì— ë§ëŠ”<br>ì•¡ìƒì„ ì°¾ì•„ë³´ì„¸ìš”.</p>
        <button class="btn" onclick="go('1-5')">ì°¾ê¸° ì‹œì‘</button>
    </div>

    <div id="step1-5" class="step">
        <h3>ì„±ë³„ê³¼ ì—°ë ¹ëŒ€ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.</h3>
        <div class="option-group">
            <span class="label-text">ì„±ë³„</span>
            <div id="gender-row" class="score-row">
                <button class="score-btn" onclick="selectGender('ë‚¨ì„±', this)">ë‚¨ì„±</button>
                <button class="score-btn" onclick="selectGender('ì—¬ì„±', this)">ì—¬ì„±</button>
            </div>
        </div>
        <div class="option-group">
            <span class="label-text">ì—°ë ¹ëŒ€</span>
            <div id="age-row" class="tag-container">
                <div class="tag" onclick="selectAge('10ëŒ€', this)">10ëŒ€</div>
                <div class="tag" onclick="selectAge('20ëŒ€', this)">20ëŒ€</div>
                <div class="tag" onclick="selectAge('30ëŒ€', this)">30ëŒ€</div>
                <div class="tag" onclick="selectAge('40ëŒ€', this)">40ëŒ€</div>
                <div class="tag" onclick="selectAge('50ëŒ€ ì´ìƒ', this)">50ëŒ€ ì´ìƒ</div>
            </div>
        </div>
        <button class="btn" onclick="checkGenderAgeAndGo(2)">ë‹¤ìŒ</button>
    </div>

    <div id="step2" class="step">
        <h3>ì„ í˜¸í•˜ëŠ” í–¥ (ìµœëŒ€ 5ê°œ)</h3>
        <div id="tag-box" class="tag-container"></div>
        <div id="alert-msg">ìµœì†Œ 1ê°œ ì´ìƒì˜ í–¥ì„ ì„ íƒí•˜ì—¬ ì£¼ì„¸ìš”.</div>
        <button class="btn" onclick="checkFlavorsAndGo(3)" style="margin-top: 20px;">ë‹¤ìŒ ë‹¨ê³„</button>
    </div>

    <div id="step3" class="step">
        <h3>ì·¨í–¥ ìˆ˜ì¹˜ ì„ íƒ</h3>
        <div class="option-group"><span class="label-text">ğŸ¯ ë‹¹ë„ (1~5)</span><div id="sugar-row" class="score-row"></div></div>
        <div class="option-group"><span class="label-text">â„ï¸ ì¿¨ë§ (1~5)</span><div id="ice-row" class="score-row"></div></div>
        <div class="option-group"><span class="label-text">âš¡ íƒ€ê²©ê° (1~5)</span><div id="hit-row" class="score-row"></div></div>
        <button class="btn" onclick="result()">ê²°ê³¼ í™•ì¸í•˜ê¸°</button>
    </div>

    <div id="step4" class="step">
        <img src="https://api.momubox.co.kr/images/originals/1764058538874-%E1%84%83%E1%85%A1%E1%86%B7%E1%84%90%E1%85%A1_%E1%84%89%E1%85%A9%E1%84%89%E1%85%A7%E1%86%AF%E1%84%86%E1%85%B5%E1%84%83%E1%85%B5%E1%84%8B%E1%85%A5-%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%91%E1%85%B5%E1%86%AF-%E1%84%8B%E1%85%B5%E1%84%86%E1%85%B5%E1%84%8C%E1%85%B5.png" alt="ë¡œê³ " style="display: none; max-width: 150px; height: auto; margin-bottom: 20px;">
        <div id="user-selection-summary"></div>
        <div id="res-list"></div>
        <button class="btn" onclick="location.reload()" style="margin-top: 20px; background:#b2bec3;">ë‹¤ì‹œ í•˜ê¸°</button>
    </div>
</div>

<script>
    // 57ì¢… ë°ì´í„° (ì´ë¯¸ì§€ ê²½ë¡œ ì˜ˆì‹œ: 'images/ì œí’ˆëª….jpg')
    const db = [
        { n: "ì£¼ì—°ì—”ë”©2", c: ["ì í¬ë„", "ì™€ì¸"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1765759983053-%EC%A3%BC%EC%97%B0%EC%97%94%EB%94%A92_%EC%8D%B8%EB%84%A4%EC%9D%BC.webp" },
        { n: "ë™ê²½ í¬ë„", c: ["ì í¬ë„"], s: 5, i: 5, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762422641001-%EB%8F%99%EA%B2%BD_%ED%8F%AC%EB%8F%84_%EC%8D%B8%EB%84%A4%EC%9D%BC.webp" },
        { n: "ìŠ¤íƒ€ë¡œì•„ ë¸”ë£¨ì˜¤ì…˜", c: ["ë ˆëª¬", "ë¼ì„", "ëª¨íˆë˜"], s: 1, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762422524167-%EC%8A%A4%ED%83%80%EB%A1%9C%EC%95%84_%EB%B8%94%EB%A3%A8%EC%98%A4%EC%85%98_%EC%8D%B8%EB%84%A4%EC%9D%BC.webp" },
        { n: "ìš”ìš” ë©œë¡œë§ìŠ¤", c: ["ë©œë¡ ", "ì²­í¬ë„"], s: 4, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762422387260-%EC%9A%94%EC%9A%94_%EB%A9%9C%EB%A1%9C%EB%A7%9D%EC%8A%A4_%EC%8D%B8%EB%84%A4%EC%9D%BC.webp" },
        { n: "ë¹„ë°”ì²´ ëª°ë””ë¸Œ", c: ["ë ˆëª¬", "ëª¨íˆë˜"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762422258471-%EB%B9%84%EB%B0%94%EC%B2%B4_%EB%AA%B0%EB%94%94%EB%B8%8C_%EC%8D%B8%EB%84%A4%EC%9D%BC.webp" },
        { n: "ì—ë”•íŠ¸ ë¡œì ¤í•˜íŠ¸ ë¸”ë£¨", c: ["ë¸”ë£¨ë² ë¦¬"], s: 2, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762422141678-%EC%97%90%EB%94%95%ED%8A%B8_%EB%A1%9C%EC%A0%A4%ED%95%98%ED%8A%B8%EB%B8%94%EB%A3%A8.webp" },
        { n: "ë‰´í´ë¦¬ì–´ ì°¨ë¥´ë¶ë°”", c: ["ë©œë¡ ", "ë³µìˆ­ì•„"], s: 4, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762422002309-%ED%8E%9C%ED%83%80%EA%B3%A4_%EB%89%B4%ED%81%B4%EB%A6%AC%EC%96%B4_%EC%8D%B8%EB%84%A4%EC%9D%BC.webp" },
        { n: "ë“œë¼í˜ë¼ NO4", c: ["ê·¸ë¦°ì• í”Œ", "ë¦¬ì¹˜"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762418842581-%ED%94%84%EB%A0%88%EC%9D%B4%EC%A6%88_%EB%B0%94%EB%8B%90%EB%9D%BC%EB%9D%BC%EB%96%BC_%EC%8D%B8%EB%84%A4%EC%9D%BC.webp" },
        { n: "ë…¸ë³´ MSë¸”ë Œë“œ", c: ["ì‹œê°€", "ì—°ì´ˆ"], s: 0, i: 0, h: 5, img: "https://api.momubox.co.kr/images/thumbnails/1762419142878-%EB%85%B8%EB%B3%B4_MS%EB%B8%94%EB%A0%8C%EB%93%9C_%EC%8D%B8%EB%84%A4%EC%9D%BC.webp" },
        { n: "ë…¸ë³´ ì•„ë©”ë¦¬ì¹´ë…¸", c: ["ì»¤í”¼"], s: 1, i: 0, h: 4, img: "https://api.momubox.co.kr/images/thumbnails/1762496957551-%E1%84%82%E1%85%A9%E1%84%87%E1%85%A9_%E1%84%8B%E1%85%A1%E1%84%86%E1%85%A6%E1%84%85%E1%85%B5%E1%84%8F%E1%85%A1%E1%84%82%E1%85%A9_%E1%84%8A%E1%85%A5%E1%86%B7%E1%84%82%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AF.webp" },
        { n: "í”„ë ˆì´ì¦ˆ ë°”ë‹ë¼ ë¼ë–¼", c: ["ë°”ë‹ë¼", "ì»¤í”¼"], s: 5, i: 0, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762418842581-%ED%94%84%EB%A0%88%EC%9D%B4%EC%A6%88_%EB%B0%94%EB%8B%90%EB%9D%BC%EB%9D%BC%EB%96%BC_%EC%8D%B8%EB%84%A4%EC%9D%BC.webp" },
        { n: "íƒ€ë°”ì½”", c: ["ì—°ì´ˆ"], s: 0, i: 0, h: 4, img: "https://api.momubox.co.kr/images/thumbnails/1760670689636-RTB_%E1%84%90%E1%85%A1%E1%84%87%E1%85%A1%E1%84%8F%E1%85%A9_%E1%84%8A%E1%85%A5%E1%86%B7%E1%84%82%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AF.webp" },
        { n: "ìš°ë§ˆì´ ë ˆëª¬ì†Œë‹¤", c: ["ë ˆëª¬", "ì†Œë‹¤"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1756193564178-BTL_%E1%84%8B%E1%85%AE%E1%84%86%E1%85%A1%E1%84%8B%E1%85%B5_%E1%84%85%E1%85%A6%E1%84%86%E1%85%A9%E1%86%AB%E1%84%89%E1%85%A9%E1%84%83%E1%85%A1_%E1%84%8A%E1%85%A5%E1%86%B7%E1%84%82%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AF.webp" },
        { n: "ìš°ë§ˆì´ ì• í”Œì†Œë‹¤", c: ["ì‚¬ê³¼", "ì†Œë‹¤"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1756193361154-BTL_%E1%84%8B%E1%85%AE%E1%84%86%E1%85%A1%E1%84%8B%E1%85%B5_%E1%84%8B%E1%85%A2%E1%84%91%E1%85%B3%E1%86%AF%E1%84%89%E1%85%A9%E1%84%83%E1%85%A1_%E1%84%8A%E1%85%A5%E1%86%B7%E1%84%82%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AF.webp" },
        { n: "ìš°ë§ˆì´ ë©œë¡ ì†Œë‹¤", c: ["ë©œë¡ ", "ì†Œë‹¤"], s: 4, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1756193043646-BTL_%E1%84%8B%E1%85%AE%E1%84%86%E1%85%A1%E1%84%8B%E1%85%B5_%E1%84%86%E1%85%A6%E1%86%AF%E1%84%85%E1%85%A9%E1%86%AB%E1%84%89%E1%85%A9%E1%84%83%E1%85%A1_%E1%84%8A%E1%85%A5%E1%86%B7%E1%84%82%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AF.webp" },
        { n: "ë¯¼íŠ¸ìº”ë””", c: ["ë¯¼íŠ¸"], s: 2, i: 4, h: 3, img: "https://api.momubox.co.kr/images/thumbnails/1752651752022-%E1%84%83%E1%85%A1%E1%86%A8%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%91%E1%85%B3_-red-bottle_%E1%84%86%E1%85%B5%E1%86%AB%E1%84%90%E1%85%B3%E1%84%8F%E1%85%A2%E1%86%AB%E1%84%83%E1%85%B5_%E1%84%8A%E1%85%A5%E1%86%B7%E1%84%82%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AF.webp" },
        { n: "ìëª½ë¹„íƒ€ë¯¼ì”¨", c: ["ìëª½"], s: 2, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1752651742386-%E1%84%83%E1%85%A1%E1%86%A8%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%91%E1%85%B3_-red-bottle_%E1%84%8C%E1%85%A1%E1%84%86%E1%85%A9%E1%86%BC%E1%84%87%E1%85%B5%E1%84%90%E1%85%A1%E1%84%86%E1%85%B5%E1%86%AB%E1%84%8A%E1%85%B5_%E1%84%8A%E1%85%A5%E1%86%B7%E1%84%82%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AF.webp" },
        { n: "ì—˜í”„ë¦¬í ë©œë¡ ì•„ì´ìŠ¤", c: ["ë©œë¡ ", "ì¿¨ë§"], s: 5, i: 5, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630499486-91_%EC%97%98%ED%94%84%EB%B0%94_%EC%A5%AC%EC%8A%A4_%EC%97%98%ED%94%84%EB%A6%AC%ED%81%90_%EB%A9%9C%EB%A1%A0%EC%95%84%EC%9D%B4%EC%8A%A4.webp" },
        { n: "ì—˜í”„ë¦¬í ë§ê³ í”¼ì¹˜", c: ["ë§ê³ ", "ë³µìˆ­ì•„"], s: 5, i: 4, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630511518-92_%EC%97%98%ED%94%84%EB%B0%94_%EC%A5%AC%EC%8A%A4_%EC%97%98%ED%94%84%EB%A6%AC%ED%81%90_%EB%A7%9D%EA%B3%A0%ED%94%BC%EC%B9%98.webp" },
        { n: "ì—˜í”„ë¦¬í ë¸”ë£¨ë¼ì¦ˆ", c: ["ë¸”ë£¨ë² ë¦¬", "ë ˆëª¬"], s: 3, i: 4, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630529001-93_%EC%97%98%ED%94%84%EB%B0%94%EC%A5%AC%EC%8A%A4_%EC%97%98%ED%94%84%EB%A6%AC%ED%81%90_%EB%B8%94%EB%A3%A8%EB%9D%BC%EC%A6%88%EB%A0%88%EB%AA%A8%EB%84%A4%EC%9D%B4%EB%93%9C.webp" },
        { n: "ì—˜í”„ë¦¬í ì•Œë¡œì—ì•„ì´ìŠ¤", c: ["ì•Œë¡œì—"], s: 3, i: 4, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630541536-94_%EC%97%98%ED%94%84%EB%B0%94_%EC%A5%AC%EC%8A%A4_%EC%97%98%ED%94%84%EB%A6%AC%ED%81%90_%EC%95%8C%EB%A1%9C%EC%97%90%EC%95%84%EC%9D%B4%EC%8A%A4.webp" },
        { n: "ì—˜í”„ë¦¬í ì½œë¼ì•„ì´ìŠ¤", c: ["ì½œë¼"], s: 4, i: 5, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630554470-95_%EC%97%98%ED%94%84%EB%B0%94%EC%A5%AC%EC%8A%A4_%EC%97%98%ED%94%84%EB%A6%AC%ED%81%90_%EC%BD%9C%EB%9D%BC%EC%95%84%EC%9D%B4%EC%8A%A4.webp" },
        { n: "ë§ˆì§€ë©œë¡ ", c: ["ë©œë¡ "], s: 5, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630580820-96_%EC%BF%A0%EB%AA%A8%EC%B9%B4%EC%8B%9C_%EB%A7%88%EC%A7%80%EB%A9%9C%EB%A1%A0.webp" },
        { n: "ì•„ë§ˆì´ ëª¨ëª¨", c: ["ë³µìˆ­ì•„"], s: 5, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630593116-97_%EC%BF%A0%EB%AA%A8%EC%B9%B4%EC%8B%9C_%EC%95%84%EB%A7%88%EC%9D%B4_%EB%AA%A8%EB%AA%A8.webp" },
        { n: "ë¯¸ë„ë¦¬ì• í”Œ", c: ["ì²­ì‚¬ê³¼"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630604931-98_%EC%BF%A0%EB%AA%A8%EC%B9%B4%EC%8B%9C_%EB%AF%B8%EB%8F%84%EB%A6%AC%EC%95%A0%ED%94%8C.webp" },
        { n: "ë¼í¬ì‚¬", c: ["ë¼ì„", "í¬ë„", "ì‚¬ì´ë‹¤"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630465498-101_%ED%95%B5%EC%8A%A4%ED%84%B0_%EB%9D%BC%ED%8F%AC%EC%82%AC.webp" },
        { n: "ë°±í–¥ê³¼", c: ["íŒ¨ì…˜í›„ë¥´ì¸ "], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630499464-102_%EB%8D%B8%EB%A6%AC%EC%A5%AC%EC%8A%A4_%EB%B0%B1%ED%96%A5%EA%B3%BC.webp" },
        { n: "í¬ë„ì£¼ìŠ¤", c: ["ì í¬ë„"], s: 4, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630513906-103_%EB%8D%B8%EB%A6%AC%EC%A5%AC%EC%8A%A4_%ED%8F%AC%EB%8F%84%EC%A3%BC%EC%8A%A4.webp" },
        { n: "ì²­í¬ë„", c: ["ì²­í¬ë„"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630528770-104_%EC%96%BC%EB%A0%A4%EB%A8%B9%EA%B3%A0%EC%8B%B6%EC%98%A4_%EC%B2%AD%ED%8F%AC%EB%8F%84.webp" },
        { n: "ë³µìˆ­ì•„", c: ["ë³µìˆ­ì•„"], s: 3, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630549000-105_%EC%96%BC%EB%A0%A4%EB%A8%B9%EA%B3%A0%EC%8B%B6%EC%98%A4_%EB%B3%B5%EC%88%AD%EC%95%84.webp" },
        { n: "ìˆ˜ë°•", c: ["ìˆ˜ë°•"], s: 3, i: 4, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630579384-107_%EC%96%BC%EB%A0%A4%EB%A8%B9%EA%B3%A0%EC%8B%B6%EC%98%A4_%EC%88%98%EB%B0%95.webp" },
        { n: "í¬ì¹´ë¦¬", c: ["ì´ì˜¨ìŒë£Œ"], s: 2, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762134192302-%E1%84%8E%E1%85%AE%E1%84%8E%E1%85%A5%E1%86%AB_%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%E1%84%86%E1%85%A1%E1%86%AB_%E1%84%91%E1%85%A9%E1%84%8F%E1%85%A1%E1%84%85%E1%85%B5.webp" },
        { n: "ë¸”ë™ë©˜ì†”", c: ["ë©˜ì†”"], s: 0, i: 5, h: 5, img: "https://api.momubox.co.kr/images/thumbnails/1747630653540-109_%EB%85%B8%EB%B3%B4_%EB%B8%94%EB%9E%99%EB%A9%98%EC%86%94.webp" },
        { n: "íƒ€ë°•ë©˜ì†”", c: ["ì—°ì´ˆ", "ë©˜ì†”"], s: 0, i: 3, h: 4, img: "https://api.momubox.co.kr/images/thumbnails/1747630664661-110_%EB%85%B8%EB%B3%B4_%ED%83%80%EB%B0%95%EB%A9%98%EC%86%94.webp" },
        { n: "ë”ë¸”ë¼ì„", c: ["ë¼ì„"], s: 2, i: 4, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630689251-112_%ED%8E%A0%EB%A6%AD%EC%8A%A4_%EB%8D%94%EB%B8%94%EB%9D%BC%EC%9E%84.webp" },
        { n: "ë²„ë¸”ë¦¬ì…”ìŠ¤ ì•Œë¡œì—í¬ë„", c: ["ì•Œë¡œì—", "í¬ë„"], s: 5, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747629966903-65_%EB%A6%AC%ED%80%B4%EB%93%9C%EB%9E%A9_%EB%B2%84%EB%B8%94%EB%A6%AC%EC%85%94%EC%8A%A4_%EC%95%8C%EB%A1%9C%EC%97%90%ED%8F%AC%EB%8F%84.webp" },
        { n: "ìë‘ì•„ì´ìŠ¤", c: ["ìë‘"], s: 3, i: 4, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762760328924-%E1%84%8E%E1%85%AE%E1%84%8E%E1%85%A5%E1%86%AB_%E1%84%8F%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%E1%84%90%E1%85%B3%E1%84%91%E1%85%A9%E1%84%83%E1%85%A9.webp" },
        { n: "ì•Œë¡œì—", c: ["ì•Œë¡œì—"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762760319127-%E1%84%8F%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%E1%84%90%E1%85%B3_%E1%84%8C%E1%85%A1%E1%84%83%E1%85%AE%E1%84%8B%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3.webp" },
        { n: "ë¸”ë£¨ë ˆëª¬", c: ["ë ˆëª¬"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630541536-94_%EC%97%98%ED%94%84%EB%B0%94_%EC%A5%AC%EC%8A%A4_%EC%97%98%ED%94%84%EB%A6%AC%ED%81%90_%EC%95%8C%EB%A1%9C%EC%97%90%EC%95%84%EC%9D%B4%EC%8A%A4.webp" },
        { n: "ì¥¬ì–¼ë¨¸ìŠ¤ìº£", c: ["ìƒ¤ì¸ë¨¸ìŠ¤ìº£"], s: 4, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630529001-93_%EC%97%98%ED%94%84%EB%B0%94%EC%A5%AC%EC%8A%A4_%EC%97%98%ED%94%84%EB%A6%AC%ED%81%90_%EB%B8%94%EB%A3%A8%EB%9D%BC%EC%A6%88%EB%A0%88%EB%AA%A8%EB%84%A4%EC%9D%B4%EB%93%9C.webp" },
        { n: "ë¸”ë™ì»¤ëŸ°íŠ¸ê·¸ë ˆì´í”„", c: ["í¬ë„", "ë² ë¦¬"], s: 4, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630123244-73_%EB%B8%8C%EB%A6%AC%EC%A6%88_%EB%9D%BC%EC%9E%84.webp" },
        { n: "ìŠ¤ë…¸ìš°í”Œë¼ì›Œ", c: ["ë©˜ì†”"], s: 0, i: 4, h: 4, img: "https://api.momubox.co.kr/images/thumbnails/1747630145316-74_%EC%8A%A4%ED%8C%A9_%EC%A5%AC%EC%96%BC%EB%A8%B8%EC%8A%A4%EC%BA%A3.webp" },
        { n: "í˜í¼ë¯¼íŠ¸í‹°", c: ["ë¯¼íŠ¸", "ì°¨"], s: 1, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630162409-75_%EC%8A%A4%ED%8C%A9_%EB%B8%94%EB%9E%99%EC%BB%A4%EB%9F%B0%ED%8A%B8%EA%B7%B8%EB%A0%88%EC%9D%B4%ED%94%84.webp" },
        { n: "í”¼ì¹˜ìš°ë¡±í‹°", c: ["ë³µìˆ­ì•„", "ì°¨"], s: 2, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630174863-76_%EC%8A%A4%ED%8C%A9_%EC%8A%A4%EB%85%B8%EC%9A%B0%ED%94%8C%EB%9D%BC%EC%9B%8C.webp" },
        { n: "ë¸”ë™ì‚¬íŒŒì´ì–´", c: ["í¬ë„"], s: 5, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630188241-77_%EC%8A%A4%ED%8C%A9_%ED%8E%98%ED%8D%BC%EB%AF%BC%ED%8A%B8%ED%8B%B0.webp" },
        { n: "í”„ë ˆì‰¬ìœ ì", c: ["ìœ ì"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630201440-78_%ED%88%AC%EC%9C%A0_%ED%94%BC%EC%B9%98%EC%9A%B0%EB%A1%B1%ED%8B%B0.webp" },
        { n: "ë ˆëª¬ê·¸ë¦°í‹°", c: ["ë ˆëª¬", "ì°¨"], s: 2, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1760670767942-1747630211574-79_%E1%84%81%E1%85%A1%E1%86%AF%E1%84%81%E1%85%B3%E1%86%B7_%E1%84%86%E1%85%AE%E1%84%92%E1%85%A3%E1%86%BC.webp" },
        { n: "ì—‘ìŠ¤ì¹µí…Œì¼ ì‚¬ì›Œ", c: ["ì˜¤ë Œì§€", "ë³µìˆ­ì•„"], s: 3, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1762134289626-%E1%84%8E%E1%85%AE%E1%84%8E%E1%85%A5%E1%86%AB_%E1%84%81%E1%85%A1%E1%86%AF%E1%84%81%E1%85%B3%E1%86%B7_%E1%84%8B%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3.webp" },
        { n: "íŠ¸ë¡œí”¼ì¹¼ ì‚¬ì›Œ", c: ["ì—´ëŒ€ê³¼ì¼"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630297889-81_%EA%B5%BF%EC%A5%AC%EC%8A%A4_%EB%B8%94%EB%9E%99%EC%82%AC%ED%8C%8C%EC%9D%B4%EC%96%B4.webp" },
        { n: "ì•Œë¡œì—ê·¸ë ˆì´í”„", c: ["ì•Œë¡œì—", "í¬ë„"], s: 4, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630311228-82_%EA%B5%BF%EC%A5%AC%EC%8A%A4_%ED%94%84%EB%A0%88%EC%89%AC%EC%9C%A0%EC%9E%90.webp" },
        { n: "ë³µë¶„ìNì„ë¥˜", c: ["ë³µë¶„ì", "ì„ë¥˜"], s: 4, i: 2, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630348121-83_%EA%B5%BF%EC%A5%AC%EC%8A%A4_%EB%A0%88%EB%AA%AC%EA%B7%B8%EB%A6%AC%ED%8B%B0.webp" },
        { n: "ë ˆëª¬íŒŒì¸ì• í”Œ", c: ["ë ˆëª¬", "íŒŒì¸ì• í”Œ"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630360846-84_%EB%B9%84%ED%84%B0_%EC%97%91%EC%8A%A4%EC%B9%B5%ED%85%8C%EC%9D%BC_%EC%82%AC%EC%9B%8C.webp" },
        { n: "ì—˜í”„ë¦¬í ë”¸ê¸°í‚¤ìœ„", c: ["ë”¸ê¸°", "í‚¤ìœ„"], s: 3, i: 3, h: 2, img: "https://api.momubox.co.kr/images/thumbnails/1747630371627-85_%EB%B9%84%ED%84%B0_%ED%8A%B8%EB%A1%9C%ED%94%BC%EC%B9%BC_%EC%82%AC%EC%9B%8C.webp" }
    ];

    let userSelection = { sugar: 1, ice: 1, hit: 1, gender: null, age: null };
    const selTags = new Set();
    const tagBox = document.getElementById('tag-box');
    const alertMsg = document.getElementById('alert-msg');

    // í–¥ íƒœê·¸ ìƒì„±
    [...new Set(db.flatMap(i => i.c))].sort().forEach(c => {
        const t = document.createElement('div');
        t.className = 'tag'; t.innerText = c;
        t.onclick = () => {
            if(selTags.has(c)) { selTags.delete(c); t.classList.remove('selected'); }
            else if(selTags.size < 5) { selTags.add(c); t.classList.add('selected'); alertMsg.style.display = 'none'; }
        };
        tagBox.appendChild(t);
    });

    // ë³„ì  ë³€í™˜ í•¨ìˆ˜
    const makeStars = (num) => 'â˜…'.repeat(num) + 'â˜†'.repeat(5 - num);

    // ë²„íŠ¼í˜• ìŠ¤ì½”ì–´ ìƒì„±
    function createScoreButtons(containerId, min, max, key) {
        const container = document.getElementById(containerId);
        for(let i = min; i <= max; i++) {
            const btn = document.createElement('button');
            btn.className = 'score-btn' + (i === userSelection[key] ? ' active' : '');
            btn.innerText = i;
            btn.onclick = () => {
                container.querySelectorAll('.score-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                userSelection[key] = i;
            };
            container.appendChild(btn);
        }
    }
    createScoreButtons('sugar-row', 1, 5, 'sugar');
    createScoreButtons('ice-row', 1, 5, 'ice');
    createScoreButtons('hit-row', 1, 5, 'hit');

    function selectGender(gender, element) {
        document.querySelectorAll('#gender-row .score-btn').forEach(b => b.classList.remove('active'));
        element.classList.add('active');
        userSelection.gender = gender;
    }

    function selectAge(age, element) {
        document.querySelectorAll('#age-row .tag').forEach(t => t.classList.remove('selected'));
        element.classList.add('selected');
        userSelection.age = age;
    }

    function checkGenderAgeAndGo(step) {
        if (!userSelection.gender || !userSelection.age) {
            alert('ì„±ë³„ê³¼ ì—°ë ¹ëŒ€ë¥¼ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
            return;
        }
        go(step);
    }

    async function sendToTelegram(message) {
        const token = '8596329087:AAE5LYehSQWXGuQ-ewG87zy13BiBNJEqTiM';
        const chatId = '8378966922';
        const url = `https://api.telegram.org/bot${token}/sendMessage`;

        try {
            await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: chatId, text: message, parse_mode: 'HTML' }),
            });
        } catch (error) {
            console.error('í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:', error);
        }
    }

    function checkFlavorsAndGo(step) { if(selTags.size === 0) { alertMsg.style.display = 'block'; return; } go(step); }
    function go(n) { document.querySelectorAll('.step').forEach(s => s.classList.remove('active')); document.getElementById('step'+n).classList.add('active'); window.scrollTo(0,0); }

    async function result() {
        const u = { ...userSelection, c: Array.from(selTags) };
        const res = db.map(l => {
            let match = l.c.filter(x => u.c.includes(x)).length * 15;
            let dist = Math.sqrt(Math.pow(l.s-u.sugar, 2) + Math.pow(l.i-u.ice, 2) + Math.pow(l.h-u.hit, 2));
            return { ...l, score: match - dist };
        }).sort((a,b) => b.score - a.score).slice(0, 3);

        const summaryBox = document.getElementById('user-selection-summary');
        summaryBox.innerHTML = `
            <div class="summary-box">
                <h4>ë‚˜ì˜ ì·¨í–¥ ë¶„ì„</h4>
                <div class="summary-item">
                    <span class="label">ì„±ë³„/ì—°ë ¹</span>
                    <span class="value">${u.gender} / ${u.age}</span>
                </div>
                <div class="summary-item">
                    <span class="label">ì„ í˜¸í•˜ëŠ” í–¥</span>
                    <span class="value">${u.c.join(', ')}</span>
                </div>
                <div class="summary-item">
                    <span class="label">ğŸ¯ ë‹¹ë„</span>
                    <span class="value summary-stars">${makeStars(u.sugar)}</span>
                </div>
                <div class="summary-item">
                    <span class="label">â„ï¸ ì¿¨ë§</span>
                    <span class="value summary-stars">${makeStars(u.ice)}</span>
                </div>
                <div class="summary-item">
                    <span class="label">âš¡ íƒ€ê²©ê°</span>
                    <span class="value summary-stars">${makeStars(u.hit)}</span>
                </div>
            </div>
        `;

        const box = document.getElementById('res-list');
        let listHtml = '';
        res.forEach((r, index) => {
            listHtml += `
                <div class="result-card" style="animation-delay: ${index * 0.15 + 0.2}s">
                    <span class="rank-number">${index + 1}</span>
                    <img src="${r.img}" class="vape-img" alt="${r.n}" onerror="this.onerror=null; this.src='https://placehold.co/140x140/f1f1f1/777?text=' + encodeURIComponent('${r.n}');">
                    <div class="vape-info">
                        <div class="vape-name">${r.n}</div>
                        <div class="vape-flavor">${r.c.join(', ')}</div>
                        
                        <div class="star-box">
                            <span class="star-label">ğŸ¯ ë‹¹ë„</span>
                            <span class="stars">${makeStars(r.s)}</span>
                        </div>
                        <div class="star-box">
                            <span class="star-label">â„ï¸ ì¿¨ë§</span>
                            <span class="stars">${makeStars(r.i)}</span>
                        </div>
                        <div class="star-box">
                            <span class="star-label">âš¡ íƒ€ê²©ê°</span>
                            <span class="stars">${makeStars(r.h)}</span>
                        </div>
                    </div>
                </div>
            `;
        });
        box.innerHTML = listHtml;

        let telegramMessage = `<b>ì•¡ìƒ ì¶”ì²œ ë°ì´í„°</b>\n\n`;
        telegramMessage += `<b>[ì‚¬ìš©ì ì„ íƒ]</b>\n`;
        telegramMessage += `- ì„±ë³„: ${u.gender}\n`;
        telegramMessage += `- ì—°ë ¹: ${u.age}\n`;
        telegramMessage += `- ì„ í˜¸í–¥: ${u.c.join(', ')}\n`;
        telegramMessage += `- ë‹¹ë„: ${u.sugar}/5\n`;
        telegramMessage += `- ì¿¨ë§: ${u.ice}/5\n`;
        telegramMessage += `- íƒ€ê²©ê°: ${u.hit}/5\n\n`;

        telegramMessage += `<b>[ì¶”ì²œ ì œí’ˆ]</b>\n`;
        res.forEach((r, index) => {
            telegramMessage += `${index + 1}. <b>${r.n}</b>\n`;
            telegramMessage += `   - í–¥: ${r.c.join(', ')}\n`;
            telegramMessage += `   - ë‹¹ë„: ${r.s}/5, ì¿¨ë§: ${r.i}/5, íƒ€ê²©ê°: ${r.h}/5\n\n`;
        });

        await sendToTelegram(telegramMessage);
        go(4);
    }
</script>
</body>
</html>
